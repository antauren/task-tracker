# async-arch-course-spring-2022
Домашние задания к курсу "Асинхронная архитектура" https://education.borshev.com/architecture

# Проектирование
[Доска в miro](https://miro.com/app/board/uXjVO42HZfw=/?share_link_id=298398888817)

# Описание

Система разделена на 4 сервиса:
- auth
- tracker
- accounting
- analytics

# Аутентификация и авторизация
Для аутентификации используется oauth2 password flow. Юзер регистрируется в auth сервисе, при логине получает jwt-токен 
и далее отправляет его на каждый запрос. Объект пользователя через кафку синхронизируется с другими сервисами. 

Когда юзер заходит в таск трекер или любой другой сервис, он снова должен залогиниться, чтобы получить токен. Трекер 
реализует собственную форму логина, но проксирует запрос в auth сервис.

Права разделяются на основе ролей. Каждый сервис при получении запроса от пользователя из jwt-токена извлекает username, 
по username достает из собственной БД объект пользователя и его роль. При необходимости проверяет доступно ли действие 
для данной роли.

# Auth приложение
Auth сервис auth-server это веб приложение на FastAPI. Сервис отвечает за регистрацию пользователей и управление 
ролями.

# Task Tracker
Трекер представлен двумя подсервисами:
- tracker-server — веб приложение на FastAPI
- tracker-consumer — кафка-консьюмер, который читает CUD-события для юзера.
